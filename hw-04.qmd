---
title: "Regression in R"
description: "Basic Concepts Regression Techniques"
author: "Bharath Velamala"
format: 
    html:
      theme: yeti
editor: visual
toc: true
code-overflow: wrap
code-annotations: hover
execute: 
  warning: false
---

## Install packages

Installing the packages used.

```{r r_packages, message = FALSE, output=FALSE}
#| code-fold: true
#| code-summary: "Packages and Theme Settings"

# Required packages
if (!require(pacman))
  install.packages("pacman")

pacman::p_load(tidymodels,
               tidyverse,
               ranger,
               dlookr,
               randomForest,
               formattable,
               glmnet,
               gridExtra)

# Global ggplot theme
# setting theme for ggplot2
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 15, base_family = "sans"))

# setting width of code output
options(width = 65)

# setting figure parameters for knitr
knitr::opts_chunk$set(
  fig.width = 8,        # 8" width
  fig.asp = 0.65,       # the golden ratio
  fig.retina = 1,       # dpi multiplier for displaying HTML output on retina
  fig.align = "center", # center align figures
  dpi = 150,            # higher dpi, sharper image
  message = FALSE
)
```

## Tidy Tuesday Dataset

I have selected the data [Big Stock Prices](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-02-07) from TidyTuesday which was sourced from Yahoo Finance via [Kaggle](https://www.kaggle.com/datasets/evangower/big-tech-stock-prices). This dataset consists of the daily stock prices and volume of 14 different tech companies, including Apple (AAPL), Amazon (AMZN), Alphabet (GOOGL), and Meta Platforms (META) and more. I will be looking for answers or some patterns by considering the below question.

**How do daily opening prices, trading volumes, and historical trends influence the adjusted closing prices of stocks?**

```{r nombats_dataset, message=FALSE}
big_stocks <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-02-07/big_tech_stock_prices.csv')

# converting the data to tibble
big_stocks <- as_tibble(big_stocks)

big_stocks |>
  diagnose() |>
  formattable()
```

By the above diagnosis, we can interpret that there are no missing values in the data. First we will generate a linear fit to the data by assuming `X` as `open` and `Y` as `adj_close`.

```{r input_output, message=FALSE}
# Setting parameters
seed <- 1               # seed for random number generation 
numInstances <- nrow(big_stocks)  # number of data instances

# Setting seed
set.seed(seed)

X <- big_stocks$open
# adding noise to the data
Y_true <- big_stocks$adj_close
Y <- Y_true + matrix(rnorm(numInstances), ncol =1)
```

Added noise to the `variable` above using a normal distribution.

```{r linear_fit, message=FALSE}
# Plotting Linear Fit 
ggplot(big_stocks, aes(X, Y)) +
  geom_point(color = "black") +
  geom_smooth(method = "lm",
              color = "red",
              linewidth = 1) +
  labs(
    title = "Stock Price relationship between open and adjusted closing price",
    x = "Open Price",
    y = "Adjusted Closing Price"
  )
```
